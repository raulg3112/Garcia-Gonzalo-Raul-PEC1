---
title: "PAC1. Anàlisi de dades òmiques (M0-157)"
author: "Raúl García"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
  pdf_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries, include=FALSE}
library(jsonlite)
library(SummarizedExperiment)
```

```{r input, include=FALSE}
json_data <- fromJSON("data/ST000001_AN000001.json")
```

# Descripció de la PAC

1. Seleccionar i descarregar un dataset de *metabolòmica*, que es pot obtenir de [metabolomicsWorkbench](https://www.metabolomicsworkbench.or/) o d'[aquest repositori](htpps://github.com/nutrimetabolomics/metaboData) de GitHub.

Dataset escollit: [*FATb Induction Experiment FatBIE*](https://www.metabolomicsworkbench.org/data/DRCCMetadata.php?Mode=Study&StudyID=ST000001)

2. Crear un objecte de classe `SummarizedExperiment` que contingui les dades i les metadades (informació sobre el dataset, les seves files i columnes). La classe `SummarizedExperiment` és una extensió d'`ExpessionSet`, utilitzada per moltes aplicacionsi bases de dades (com és el cas de metabolomicsWorkbench). Quines són les seves principals diferències amb la classe `ExpressionSet`?

```{r}
# Implementació de les dades de tota la información del fitxer JSON.
dades <- json_data$MS_METABOLITE_DATA$Data

# Transformació de la informació de totes les columnes a número emprant la funció `as.numeric()` Evitem la primera columna degut a que conté la informació dels metabolits.
dades[ , -1] <- lapply(dades[ , -1], as.numeric)

# Es converteix la información en matriu amb `as.matrix()`. Aquesta matriu es pot nombrar com matriu d'expressió.
matriu_expressio <- as.matrix(dades[ , -1])

# S'afegeixen el nom dels metabolits a cada fila i els noms de cada columna.
rownames(matriu_expressio) <- dades[ , 1]
colnames(matriu_expressio) <- colnames(dades[ , -1])

# Es genera un dataframe amb la informació per `colData`. 
col_data <- DataFrame(json_data$SUBJECT_SAMPLE_FACTORS)

# Es genera també el dataframe amn la informació per 'rowData'.
row_data <- DataFrame(dades[[1]])
rownames(row_data) <- rownames(matriu_expressio)

# Generació de l'objecte de classe `SummarizedExperiment`.
se <- SummarizedExperiment(assays = list(intensity = matriu_expressio), colData = col_data, rowData = row_data)

# Paral·lelament, es generen les metadades de l'objecte. 
metadata(se) <- list(Study = json_data$STUDY, Project = json_data$PROJECT, Subject = json_data$SUBJECT, Collection = json_data$COLLECTION, Treatment = json_data$TREATMENT, SamplePrep = json_data$SAMPLEPREP, Cromatography = json_data$CHROMATOGRAPHY, Analysis = json_data$ANALYSIS, MS = json_data$MS)
```

3. Portar a terme una anàlisi exploratòria que proporcioni una visió general del dataset en la línia del que s'ha vist en les activitats d'aquest repte.



4. Elaborar un informe que descrigui el procés que s'ha utilitzat, incloent-hi la justificació de la selecció del dataset, la seva incorporació al `SummarizedExperiment`, l'anàlisi exploratòria de les dades i la interpretació dels resultats des del punt de vista biològic. L'extensió màxima d'aquest informe (sense tenir en compte els Annexos) ha de ser de **10 pàgines**), en format PDF.

5. Crear un respositori GitHub que contingui: 

* l'informe

* l'objecte de classe `SummarizedExperiment` que contingui les dades i les metadades en format binari (.Rda)

* el codi R per a l'exploració de les dades degudament comentat (el control de versions del mateix s'ha de realitzar amb Git)

* dades en format text

* les metadades acompanyados d'una breu descripció en un arxiu markdown

El nom de repositori ha de ser 'Cognom1-Cognom2-Nom-PEC1'. La direcció (*URL*) del repositori haurà d'estar inclosa en l'informe de manera clara. Teniu en compte que a través de CANVAS deveu lliurar únicament l'informe. 

# Recursos

Els recursos per dur a terme la PEC són els que s'han proporcionat en les diferents activitats del primer repte. A més, haureu de familiaritzar-vos amb la classe `SummarizedExperiment`. Per això podeu utilizar [aquest tutorial](https://bioconductor.org/packages/release/bioc/vignettes/SummarizedExperiment/inst/doc/SummarizedExperiment.html) de Bioconductor. 

# ABSTRACT

- RESUM PROCÉS I PRINCIPALS RESULTATS

# OBJECTIUS

- ELECCIÓ DADES

- CREACIÓ `SUMMARIZEDEXPERIMENT`

- OBSERVACIÓ DE LES DADES

# MÈTODES

- FITXER (tipus de dades) I ENLLAÇ (font d'origen)

- METODOLOGIA

- EINES ESTADÍSTIQUES I BIOINFORMÀTIQUES UTILITZADES

- PROCEDIMENT GENERAL D'ANÀLISI

- ETC

# RESULTATS

- CREACIÓ `SUMMARIZEDEXPERIMENT`

- ANÀLISI EXPLORATÒRIA

# DISCUSSIÓ

- REFLEXIÓ DE LES LIMITACIONS DE L'ESTUDI

- REFLEXIÓ DEL TREBALL REALITZAT (EN EL CONTEXT DEL PROBLEMA BIOLÒGIC D'INTERÈS QUE ABORDA LA PEC)

# CONCLUSIONS

- SIMPLES I DIRECTES

# REFERÈNCIES

- Repositori GitHub: https://github.com/raulg3112/Garcia-Gonzalo-Raul-PEC1.git

- DATA SELECCIONADA

